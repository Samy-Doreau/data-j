{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-08T16:25:11.729923Z", "invocation_id": "0deaaec6-3689-4b41-bced-8b9d5232ed69", "invocation_started_at": "2025-09-08T16:25:10.346296Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.146276Z", "completed_at": "2025-09-08T16:25:11.153423Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.153742Z", "completed_at": "2025-09-08T16:25:11.235439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09004902839660645, "adapter_response": {"_message": "SELECT 45", "code": "SELECT", "rows_affected": 45}, "message": "SELECT 45", "failures": null, "unique_id": "model.highstreet_tenure.stg_filemap", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"highstreet\".\"public\".\"filename_mapping\"\n),\n\nextracted as (\n    select\n        id,\n        source_file,\n        loaded_at,\n        -- Extract fields from the JSON data column\n        data->>'file_name' as file_name,\n        data->>'table_name' as table_name,\n        data->>'valid_from' as valid_from,\n        data->>'valid_to' as valid_to\n    from source\n)\n\nselect * from extracted", "relation_name": "\"highstreet\".\"analytics_analytics\".\"stg_filemap\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.249512Z", "completed_at": "2025-09-08T16:25:11.257776Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.261093Z", "completed_at": "2025-09-08T16:25:11.331092Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09002876281738281, "adapter_response": {"_message": "SELECT 1307", "code": "SELECT", "rows_affected": 1307}, "message": "SELECT 1307", "failures": null, "unique_id": "model.highstreet_tenure.stg_new_businesses", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"highstreet\".\"public\".\"new_businesses\"\n),\n\nfilemap as (\n    select file_name, valid_from, valid_to from \"highstreet\".\"analytics_analytics\".\"stg_filemap\"\n    where table_name = 'new_businesses'\n),\n\nextracted as (\n    select\n        source.id,\n        source_file,\n        loaded_at,\n        -- Extract fields from the JSON data column\n        data->>'current_analysis_code_description' as current_analysis_code_description,\n        data->>'primary_liable_party_name' as primary_liable_party_name,\n        data->>'full_property_address' as full_property_address,\n        data->>'liable_responsibility_start_date' as liable_responsibility_start_date,\n        (data->>'current_rateable_value')::numeric as current_rateable_value,\n        data->>'property_reference_number' as property_reference_number,\n        filemap.valid_from as valid_from,\n        filemap.valid_to as valid_to\n    from source\n    left join filemap on source.source_file = filemap.file_name\n)\n\nselect * from extracted", "relation_name": "\"highstreet\".\"analytics_analytics\".\"stg_new_businesses\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.242795Z", "completed_at": "2025-09-08T16:25:11.252044Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.252625Z", "completed_at": "2025-09-08T16:25:11.344210Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10402703285217285, "adapter_response": {"_message": "SELECT 2683", "code": "SELECT", "rows_affected": 2683}, "message": "SELECT 2683", "failures": null, "unique_id": "model.highstreet_tenure.stg_accounts_closed", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"highstreet\".\"public\".\"accounts_closed\"\n),\n\nfilemap as (\n    select file_name, valid_from, valid_to from \"highstreet\".\"analytics_analytics\".\"stg_filemap\"\n    where table_name = 'accounts_closed'\n),\n\nextracted as (\n    select\n        source.id,\n        source.source_file,\n        source.loaded_at,\n        -- Extract fields from the JSON data column\n        data->>'account_start_date' as account_start_date,\n        data->>'account_end_date' as account_end_date,\n        (data->>'outstanding_debt')::numeric as outstanding_debt,\n        data->>'full_property_address' as full_property_address,\n        data->>'primary_liable_party_name' as primary_liable_party_name,\n        data->>'property_reference_number' as property_reference_number,\n        filemap.valid_from as valid_from,\n        filemap.valid_to as valid_to\n    from source\n    left join filemap on source.source_file = filemap.file_name\n)\n\nselect * from extracted", "relation_name": "\"highstreet\".\"analytics_analytics\".\"stg_accounts_closed\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.245324Z", "completed_at": "2025-09-08T16:25:11.252292Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.255305Z", "completed_at": "2025-09-08T16:25:11.485956Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.24521899223327637, "adapter_response": {"_message": "SELECT 27009", "code": "SELECT", "rows_affected": 27009}, "message": "SELECT 27009", "failures": null, "unique_id": "model.highstreet_tenure.stg_accounts_no_relief", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"highstreet\".\"public\".\"accounts_no_relief\"\n),\n\nfilemap as (\n    select file_name, valid_from, valid_to from \"highstreet\".\"analytics_analytics\".\"stg_filemap\"\n    where table_name = 'accounts_no_relief'\n),\n\nextracted as (\n    select\n        source.id,\n        source_file,\n        loaded_at,\n        -- Extract fields from the JSON data column\n        data->>'billing_period' as billing_period,\n        data->>'full_property_address' as full_property_address,\n        (data->>'current_rateable_value')::numeric as current_rateable_value,\n        data->>'primary_liable_party_name' as primary_liable_party_name,\n        data->>'property_reference_number' as property_reference_number,\n        (data->>'a_c_summary_current_liability')::numeric as a_c_summary_current_liability,\n        data->>'liable_responsibility_start_date' as liable_responsibility_start_date,\n        filemap.valid_from as valid_from,\n        filemap.valid_to as valid_to\n    from source\n    left join filemap on source.source_file = filemap.file_name\n)\n\nselect * from extracted", "relation_name": "\"highstreet\".\"analytics_analytics\".\"stg_accounts_no_relief\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.247241Z", "completed_at": "2025-09-08T16:25:11.257497Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.258059Z", "completed_at": "2025-09-08T16:25:11.491463Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2503499984741211, "adapter_response": {"_message": "SELECT 28209", "code": "SELECT", "rows_affected": 28209}, "message": "SELECT 28209", "failures": null, "unique_id": "model.highstreet_tenure.stg_accounts_relief", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"highstreet\".\"public\".\"accounts_relief\"\n),\n\nfilemap as (\n    select file_name, valid_from, valid_to from \"highstreet\".\"analytics_analytics\".\"stg_filemap\"\n    where table_name = 'accounts_with_relief'\n),\n\nextracted as (\n    select\n        source.id,\n        source_file,\n        loaded_at,\n        -- Extract fields from the JSON data column\n        data->>'current_relief_type' as current_relief_type,\n        data->>'full_property_address' as full_property_address,\n        (data->>'current_rateable_value')::numeric as current_rateable_value,\n        data->>'primary_liable_party_name' as primary_liable_party_name,\n        data->>'property_reference_number' as property_reference_number,\n        data->>'current_relief_award_start_date' as current_relief_award_start_date,\n        data->>'current_relief_type_description' as current_relief_type_description,\n        data->>'liable_responsibility_start_date' as liable_responsibility_start_date,\n        (data->>'current_relief_award_perc_awarded')::numeric as current_relief_award_perc_awarded,\n        filemap.valid_from as valid_from,\n        filemap.valid_to as valid_to\n    from source\n    left join filemap on source.source_file = filemap.file_name\n)\n\nselect * from extracted", "relation_name": "\"highstreet\".\"analytics_analytics\".\"stg_accounts_relief\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.494380Z", "completed_at": "2025-09-08T16:25:11.497174Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.497487Z", "completed_at": "2025-09-08T16:25:11.667192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17432212829589844, "adapter_response": {"_message": "SELECT 59208", "code": "SELECT", "rows_affected": 59208}, "message": "SELECT 59208", "failures": null, "unique_id": "model.highstreet_tenure.business_timeline", "compiled": true, "compiled_code": "\n\nwith account_ends as (\n    select \n        primary_liable_party_name as business_name, \n        account_end_date  as event_date, \n        'account_end' as event_type\n    from \"highstreet\".\"analytics_analytics\".\"stg_accounts_closed\"\n),\n\naccounts_new as (\n    select \n        primary_liable_party_name as business_name, \n        liable_responsibility_start_date as event_date, \n        'account_start' as event_type\n    from \"highstreet\".\"analytics_analytics\".\"stg_new_businesses\"\n),\n\naccounts_no_relief_active as (\n    select \n        primary_liable_party_name as business_name, \n        liable_responsibility_start_date as event_date, \n        'account_active' as event_type\n    from \"highstreet\".\"analytics_analytics\".\"stg_accounts_no_relief\"\n),\n\naccounts_relief_active as (\n    select \n        primary_liable_party_name as business_name, \n        liable_responsibility_start_date as event_date, \n        'account_active' as event_type\n    from \"highstreet\".\"analytics_analytics\".\"stg_accounts_relief\"\n),\n\ncombined_accounts as (\n    select * from account_ends\n    union all\n    select * from accounts_new\n    union all\n    select * from accounts_no_relief_active\n    union all\n    select * from accounts_relief_active\n)\n\nselect * from combined_accounts order by business_name, event_date", "relation_name": "\"highstreet\".\"analytics_analytics\".\"business_timeline\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-08T16:25:11.671099Z", "completed_at": "2025-09-08T16:25:11.673069Z"}, {"name": "execute", "started_at": "2025-09-08T16:25:11.673276Z", "completed_at": "2025-09-08T16:25:11.713674Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04333901405334473, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.highstreet_tenure.business_with_full_timeline", "compiled": true, "compiled_code": "with \n\nbusiness_timeline as (\n    select * from \"highstreet\".\"analytics_analytics\".\"business_timeline\"\n),\n\nnew_event_counts_by_business as (\n    select \n        business_name,\n        count(*) as new_event_count\n    from business_timeline\n    where event_type = 'account_start'\n    group by 1\n    having count(*) > 1\n),\n\nend_event_counts_by_business as (\n    select \n        business_name,\n        count(*) as end_event_count\n    from business_timeline\n    where event_type = 'account_end'\n    group by 1\n    having count(*) > 1\n)\n\nselect business_timeline.* \nfrom business_timeline\ninner join new_event_counts_by_business on business_timeline.business_name = new_event_counts_by_business.business_name\ninner join end_event_counts_by_business on business_timeline.business_name = end_event_counts_by_business.business_name\norder by business_timeline.business_name, business_timeline.event_date desc", "relation_name": "\"highstreet\".\"analytics_analytics\".\"business_with_full_timeline\"", "batch_results": null}], "elapsed_time": 0.7545921802520752, "args": {"require_all_warnings_handled_by_warn_error": false, "use_colors": true, "project_dir": "/Users/samydoreau/data-j/highstreet-tenure", "show_resource_report": false, "validate_macro_args": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_level": "info", "log_path": "/Users/samydoreau/data-j/highstreet-tenure/logs", "state_modified_compare_vars": false, "cache_selected_only": false, "require_generic_test_arguments_property": true, "introspect": true, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": true, "log_level_file": "debug", "profiles_dir": "/Users/samydoreau/data-j/highstreet-tenure", "use_fast_test_edges": false, "empty": false, "macro_debugging": false, "partial_parse_file_diff": true, "which": "run", "write_json": true, "favor_state": false, "quiet": false, "static_parser": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "show_all_deprecations": false, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "partial_parse": true, "strict_mode": false, "select": ["+business_with_full_timeline"], "invocation_command": "dbt run -m +business_with_full_timeline", "version_check": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_file_max_bytes": 10485760, "print": true, "skip_nodes_if_on_run_start_fails": false, "require_yaml_configuration_for_mf_time_spines": false, "defer": false, "printer_width": 80, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "vars": {}, "log_format_file": "debug", "log_format": "default", "use_colors_file": true, "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true}}